{
  "checks": [
    {
      "category": "APPS & RUNTIME",
      "label": "Root Access (su)",
      "command": "su -c 'id' 2>/dev/null | grep -q 'uid=0' && echo 'ROOT_ACTIVE' || which su 2>/dev/null | grep -v '/system/bin/su'",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Check for actual root shell access (excludes Samsung system su)",
      "empty_is_safe": true
    },
    {
      "category": "APPS & RUNTIME",
      "label": "Running Services Count",
      "command": "dumpsys activity services | grep -E 'package|process' | wc -l",
      "safe_pattern": ".*",
      "level": "info",
      "description": "Running services on device"
    },
    {
      "category": "APPS & RUNTIME",
      "label": "Frida Detected",
      "command": "pm list packages | grep frida",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Frida binary indicates runtime manipulation",
      "empty_is_safe": true
    },
    {
      "category": "APPS & RUNTIME",
      "label": "Magisk Detected",
      "command": "pm list packages | grep magisk",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Magisk can hide root access",
      "empty_is_safe": true
    },
    {
      "category": "APPS & RUNTIME",
      "label": "Xposed Framework",
      "command": "pm list packages | grep xposed",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Xposed framework enables deep system tweaks",
      "empty_is_safe": true
    },
    {
      "category": "APPS & RUNTIME",
      "label": "Unapproved APKs in /data/local/tmp",
      "command": "ls /data/local/tmp/*.apk",
      "safe_pattern": "^ls:.*No such file or directory$",
      "level": "warning",
      "description": "Unauthorized sideloading or testing APKs"
    }
  ]
}