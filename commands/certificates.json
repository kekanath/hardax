{
  "checks": [
    {
      "category": "CERTIFICATES",
      "label": "User-Installed CA Certificates",
      "command": "ls /data/misc/user/0/cacerts-added/ 2>/dev/null | wc -l",
      "safe_pattern": "^0$",
      "level": "critical",
      "description": "User CA certs can enable MITM attacks - review if present"
    },
    {
      "category": "CERTIFICATES",
      "label": "System CA Store Modified",
      "command": "ls /system/etc/security/cacerts/ 2>/dev/null | wc -l",
      "safe_pattern": "^[1-9][0-9]{2}$",
      "level": "warning",
      "description": "System CA store should have standard number of certs (~150)"
    },
    {
      "category": "CERTIFICATES",
      "label": "Certificate Pinning Bypass Apps",
      "command": "pm list packages | grep -iE 'sslunpin|trustme|justtrustme|certbypass'",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "SSL pinning bypass tools detected"
    },
    {
      "category": "CERTIFICATES",
      "label": "Network Security Config",
      "command": "find /data/app -name 'network_security_config.xml' 2>/dev/null | wc -l",
      "safe_pattern": ".*",
      "level": "info",
      "description": "Apps using network security configuration"
    },
    {
      "category": "CERTIFICATES",
      "label": "Cleartext Traffic Permitted",
      "command": "settings get global captive_portal_use_https 2>/dev/null",
      "safe_pattern": "^1$",
      "level": "warning",
      "description": "HTTPS should be enforced for captive portal detection"
    }
  ]
}
