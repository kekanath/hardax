{
  "checks": [
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "System CA Certificate Count",
      "command": "ls /system/etc/security/cacerts/ 2>/dev/null | wc -l",
      "safe_pattern": "^[0-9]+$",
      "level": "info",
      "description": "Count of system CA certificates in trust store"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "User-Installed Certificates",
      "command": "ls /data/misc/user/0/cacerts-added/ 2>/dev/null | wc -l",
      "safe_pattern": "^0$",
      "level": "critical",
      "description": "User-installed CA certificates (potential MITM risk) - should be 0"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "User Certificate Files",
      "command": "ls -la /data/misc/user/0/cacerts-added/ 2>/dev/null",
      "safe_pattern": "No such file|total 0|^$",
      "level": "critical",
      "description": "List of user-installed certificates - should be empty"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Certificate Pinning Bypass Apps",
      "command": "pm list packages 2>/dev/null | grep -iE 'sslunpin|trustme|justtrustme|unpinner|certpinner'",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Apps that bypass certificate pinning - should not be installed"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Network Security Config Files",
      "command": "find /data/app -name 'network_security_config.xml' 2>/dev/null | head -5",
      "safe_pattern": ".+",
      "level": "info",
      "description": "Apps with custom network security configuration"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Hardware Keystore Type",
      "command": "getprop ro.hardware.keystore 2>/dev/null",
      "safe_pattern": ".+",
      "level": "info",
      "description": "Hardware keystore implementation type"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "StrongBox Support",
      "command": "ls /vendor/lib64/hw/android.hardware.strongbox* 2>/dev/null | head -1",
      "safe_pattern": ".+",
      "level": "info",
      "description": "StrongBox hardware security module availability"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Keystore Credentials Count",
      "command": "ls /data/misc/keystore/user_0/ 2>/dev/null | wc -l",
      "safe_pattern": "^[0-9]+$",
      "level": "info",
      "description": "Keystore credential entries count"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "VPN Lockdown Mode",
      "command": "settings get global always_on_vpn_lockdown 2>/dev/null",
      "safe_pattern": "^1$",
      "level": "info",
      "description": "VPN lockdown mode requiring certificate"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Conscrypt TLS Provider",
      "command": "pm list packages 2>/dev/null | grep conscrypt",
      "safe_pattern": "conscrypt",
      "level": "info",
      "description": "Google Conscrypt TLS provider installed"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "HTTP Proxy Configured",
      "command": "settings get global http_proxy 2>/dev/null",
      "safe_pattern": "^null$|^$",
      "level": "warning",
      "description": "HTTP proxy configured - may intercept HTTPS traffic"
    },
    {
      "category": "CERTIFICATE_AUDIT",
      "label": "Global Proxy Host",
      "command": "settings get global global_http_proxy_host 2>/dev/null",
      "safe_pattern": "^null$|^$",
      "level": "warning",
      "description": "Global HTTP proxy host - may intercept traffic"
    }
  ]
}
