{
  "checks": [
    {
      "category": "DM-VERITY",
      "label": "Verity Mode (cmdline)",
      "command": "grep -o 'androidboot.veritymode=[^ ]*' /proc/cmdline | cut -d= -f2",
      "safe_pattern": "^enforcing$",
      "level": "critical",
      "description": "dm-verity should be enforcing"
    },
    {
      "category": "DM-VERITY",
      "label": "dm-verity-backed Partitions Mounted",
      "command": "mount | awk '$1 ~ /^dm-/ && $3 ~ /(ext4|f2fs)/ {c++} END{print c+0}'",
      "safe_pattern": "^[1-9][0-9]*$",
      "level": "high",
      "description": "At least one partition should be backed by dm-verity"
    },
    {
      "category": "DM-VERITY",
      "label": "AVB/Verity Success in dmesg",
      "command": "dmesg 2>/dev/null | grep -iE 'avb.*(success|green)|dm-verity:.*(enabled|ready|using)' | wc -l",
      "safe_pattern": "^[1-9][0-9]*$",
      "level": "info",
      "description": "Kernel logs should show AVB/verity success (if accessible)"
    }
  ]
}