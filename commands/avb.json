{
  "checks": [
    {
      "category": "AVB",
      "label": "Verified Boot State",
      "command": "getprop ro.boot.verifiedbootstate",
      "safe_pattern": "^green$",
      "level": "critical",
      "description": "AVB verifiedbootstate must be green"
    },
    {
      "category": "AVB",
      "label": "vbmeta Device State",
      "command": "getprop ro.boot.vbmeta.device_state",
      "safe_pattern": "^locked$",
      "level": "critical",
      "description": "vbmeta device_state must be locked"
    },
    {
      "category": "AVB",
      "label": "AVB Version Present",
      "command": "getprop ro.boot.avb_version",
      "safe_pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?$",
      "level": "info",
      "description": "AVB version should be present"
    },
    {
      "category": "AVB",
      "label": "vbmeta Digest Present (cmdline)",
      "command": "grep -q 'androidboot.vbmeta.digest=' /proc/cmdline && echo present || echo absent",
      "safe_pattern": "^present$",
      "level": "info",
      "description": "vbmeta digest present in kernel cmdline"
    },
    {
      "category": "AVB",
      "label": "Verified Boot State (cmdline)",
      "command": "grep -o 'androidboot.verifiedbootstate=[^ ]*' /proc/cmdline | cut -d= -f2",
      "safe_pattern": "^green$",
      "level": "high",
      "description": "Kernel cmdline indicates green state"
    },
    {
      "category": "AVB",
      "label": "vbmeta Device State (cmdline)",
      "command": "grep -o 'androidboot.vbmeta.device_state=[^ ]*' /proc/cmdline | cut -d= -f2",
      "safe_pattern": "^locked$",
      "level": "high",
      "description": "Kernel cmdline shows vbmeta locked"
    },
    {
      "category": "AVB",
      "label": "avbctl Present",
      "command": "command -v avbctl >/dev/null 2>&1 && echo present || echo absent",
      "safe_pattern": "^present$",
      "level": "info",
      "description": "avbctl binary available for rollback checks"
    },
    {
      "category": "AVB",
      "label": "Rollback Index (slot 0) > 0",
      "command": "command -v avbctl >/dev/null 2>&1 && avbctl get-rollback-index 0 2>/dev/null | awk '{print $NF}' || echo 0",
      "safe_pattern": "^[1-9][0-9]*$",
      "level": "high",
      "description": "Anti-rollback index should be > 0 (slot 0)"
    },
    {
      "category": "AVB",
      "label": "Rollback Index (slot 1) > 0",
      "command": "command -v avbctl >/dev/null 2>&1 && avbctl get-rollback-index 1 2>/dev/null | awk '{print $NF}' || echo 0",
      "safe_pattern": "^[1-9][0-9]*$",
      "level": "high",
      "description": "Anti-rollback index should be > 0 (slot 1)"
    }
  ]
}