{
  "checks": [
    {
      "category": "PRIVACY",
      "label": "Microphone Mute",
      "command": "settings get global microphone_mute",
      "safe_pattern": ".",
      "level": "info",
      "description": "Hardware microphone mute status"
    },
    {
      "category": "PRIVACY",
      "label": "Camera Mute",
      "command": "settings get global camera_mute",
      "safe_pattern": ".",
      "level": "info",
      "description": "Hardware camera mute status"
    },
    {
      "category": "PRIVACY",
      "label": "Voice Recording Apps",
      "command": "dumpsys media.audio_policy 2>/dev/null | grep -i 'recording' | head -5",
      "safe_pattern": ".",
      "level": "info",
      "description": "Apps using audio recording"
    },
    {
      "category": "PRIVACY",
      "label": "Fingerprint Enrolled",
      "command": "settings get secure fingerprint_enrolled_fingers",
      "safe_pattern": ".",
      "level": "info",
      "description": "Check if fingerprint authentication is enrolled"
    },
    {
      "category": "PRIVACY",
      "label": "Face Unlock Status",
      "command": "settings get secure face_unlock_method",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Face unlock may be less secure than fingerprint"
    },
    {
      "category": "PRIVACY",
      "label": "Auto-Lock After Biometric",
      "command": "settings get secure lock_screen_lock_after_timeout",
      "safe_pattern": ".",
      "level": "info",
      "description": "Auto-lock timeout after biometric failure"
    },
    {
      "category": "PRIVACY",
      "label": "Biometric Keyguard Enabled",
      "command": "settings get secure biometric_keyguard_enabled",
      "safe_pattern": "1",
      "level": "warning",
      "description": "Biometric keyguard should be enabled for secure unlock"
    },
    {
      "category": "PRIVACY",
      "label": "Clipboard Access Notification",
      "command": "settings get secure show_clipboard_access_notification",
      "safe_pattern": "1",
      "level": "warning",
      "description": "Should notify when apps access clipboard"
    },
    {
      "category": "PRIVACY",
      "label": "Clipboard Service",
      "command": "dumpsys clipboard 2>/dev/null | head -10",
      "safe_pattern": ".",
      "level": "info",
      "description": "Clipboard service status"
    },
    {
      "category": "PRIVACY",
      "label": "Screen Brightness Mode",
      "command": "settings get system screen_brightness_mode",
      "safe_pattern": ".",
      "level": "info",
      "description": "Auto-brightness status"
    },
    {
      "category": "PRIVACY",
      "label": "Adaptive Brightness",
      "command": "settings get system screen_auto_brightness_adj",
      "safe_pattern": ".",
      "level": "info",
      "description": "Adaptive brightness setting"
    },
    {
      "category": "PRIVACY",
      "label": "Always On Display",
      "command": "settings get secure doze_always_on",
      "safe_pattern": "0|null",
      "level": "info",
      "description": "Always on display may show sensitive info"
    },
    {
      "category": "PRIVACY",
      "label": "Screenshot Prevention",
      "command": "settings get secure screensaver_enabled",
      "safe_pattern": ".",
      "level": "info",
      "description": "Screensaver/daydream configuration"
    },
    {
      "category": "PRIVACY",
      "label": "Location Services Mode",
      "command": "settings get secure location_mode",
      "safe_pattern": "0",
      "level": "info",
      "description": "Location services mode (0=off, 3=high accuracy)"
    },
    {
      "category": "PRIVACY",
      "label": "GPS Enabled",
      "command": "settings get secure location_providers_allowed",
      "safe_pattern": ".",
      "level": "info",
      "description": "Allowed location providers"
    },
    {
      "category": "PRIVACY",
      "label": "Location History",
      "command": "settings get secure location_history_enabled",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Location history can be privacy concern"
    },
    {
      "category": "PRIVACY",
      "label": "Network Location Provider",
      "command": "settings get secure network_location_opt_in",
      "safe_pattern": ".",
      "level": "info",
      "description": "Network-based location opt-in status"
    },
    {
      "category": "PRIVACY",
      "label": "Notification Listeners",
      "command": "settings get secure enabled_notification_listeners",
      "safe_pattern": "^$|null",
      "level": "warning",
      "description": "Notification listeners can read all notifications including OTPs"
    },
    {
      "category": "PRIVACY",
      "label": "Notification Policy Access",
      "command": "settings get secure enabled_notification_policy_access_packages",
      "safe_pattern": ".",
      "level": "info",
      "description": "Apps with notification policy access"
    },
    {
      "category": "PRIVACY",
      "label": "Lock Screen Notifications",
      "command": "settings get secure lock_screen_allow_private_notifications",
      "safe_pattern": "0",
      "level": "warning",
      "description": "Private notifications on lock screen"
    },
    {
      "category": "PRIVACY",
      "label": "Heads Up Notifications",
      "command": "settings get global heads_up_notifications_enabled",
      "safe_pattern": ".",
      "level": "info",
      "description": "Heads up notification display"
    },
    {
      "category": "PRIVACY",
      "label": "Screen Lock Enabled",
      "command": "settings get secure lockscreen.password_type",
      "safe_pattern": "65536|131072|196608|262144|327680|393216",
      "level": "critical",
      "description": "Device should have PIN/Password/Pattern lock enabled"
    },
    {
      "category": "PRIVACY",
      "label": "Lock Screen Timeout",
      "command": "settings get system screen_off_timeout",
      "safe_pattern": "^(1[0-9]{4}|[1-9][0-9]{0,3})$",
      "level": "warning",
      "description": "Screen timeout should be 30 seconds or less for security"
    },
    {
      "category": "PRIVACY",
      "label": "Show Passwords Disabled",
      "command": "settings get system show_password",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Passwords should not be shown when typing"
    },
    {
      "category": "PRIVACY",
      "label": "Lock Screen Notification Visibility",
      "command": "settings get secure lock_screen_show_notifications",
      "safe_pattern": "0",
      "level": "warning",
      "description": "Sensitive notifications should be hidden on lock screen"
    },
    {
      "category": "PRIVACY",
      "label": "Smart Lock Disabled",
      "command": "settings get secure trust_agents_initialized",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Smart Lock may reduce security by keeping device unlocked"
    },
    {
      "category": "PRIVACY",
      "label": "Sensors Privacy Mode",
      "command": "settings get secure sensors_off",
      "safe_pattern": ".",
      "level": "info",
      "description": "Sensor privacy mode status"
    },
    {
      "category": "PRIVACY",
      "label": "Step Counter",
      "command": "dumpsys sensorservice 2>/dev/null | grep -i 'step' | head -3",
      "safe_pattern": ".",
      "level": "info",
      "description": "Step counter sensor status"
    },
    {
      "category": "PRIVACY",
      "label": "Active Sensors",
      "command": "dumpsys sensorservice 2>/dev/null | grep -i 'active' | head -10",
      "safe_pattern": ".",
      "level": "info",
      "description": "Currently active sensors"
    },
    {
      "category": "PRIVACY",
      "label": "Screen Lock",
      "command": "dumpsys window policy 2>/dev/null | grep -i 'showing.*lock\\|isShowing' || dumpsys trust 2>/dev/null | grep -i 'enabled' || settings get secure lockscreen.password_type 2>/dev/null",
      "safe_pattern": ".",
      "level": "info",
      "description": "Screen lock status (multiple detection methods)"
    },
    {
      "category": "PRIVACY",
      "label": "Clipboard Access",
      "command": "cmd clipboard get-primary-clip",
      "safe_pattern": "^$",
      "level": "info",
      "description": "Check if clipboard has sensitive data",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Clipboard History",
      "command": "dumpsys clipboard | grep 'Historical'",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Clipboard history should be disabled to prevent data leaks",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Biometric Strength",
      "command": "dumpsys biometric | grep 'Strength='",
      "safe_pattern": "STRONG",
      "level": "warning",
      "description": "Biometric auth should be 'STRONG' (not 'WEAK')"
    },
    {
      "category": "PRIVACY",
      "label": "Backup Allowed",
      "command": "settings get global backup_enabled",
      "safe_pattern": "^0$",
      "level": "warning",
      "description": "Auto-backup should be disabled for sensitive apps"
    },
    {
      "category": "PRIVACY",
      "label": "Fingerprint / Setup Complete",
      "command": "settings get secure user_setup_complete",
      "safe_pattern": "^1$",
      "level": "info",
      "description": "Check if device setup is complete"
    },
    {
      "category": "PRIVACY",
      "label": "Trust Agents Enabled",
      "command": "settings get secure enabled_trust_agents",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "May allow unlock bypass via smart lock",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Microphone Usage",
      "command": "dumpsys media.audio_flinger | grep -i active",
      "safe_pattern": "^$",
      "level": "info",
      "description": "Detects open microphones",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Camera Usage",
      "command": "dumpsys media.camera | grep -i client",
      "safe_pattern": "^$",
      "level": "info",
      "description": "Detects active camera clients",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Sensors in Use",
      "command": "dumpsys sensorservice | grep 'active' | grep -v '0'",
      "safe_pattern": "^$",
      "level": "info",
      "description": "Shows currently used sensors",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Network Telemetry",
      "command": "settings get global usage_reporting_enabled",
      "safe_pattern": "^0$",
      "level": "info",
      "description": "Should be disabled unless required"
    },
    {
      "category": "PRIVACY",
      "label": "Sensitive Data in Logs",
      "command": "logcat -d 2>/dev/null | grep -iE 'password|token|key|secret|credential' | head -5",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Sensitive data found in system logs",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Unencrypted Data Partition",
      "command": "getprop ro.crypto.state 2>/dev/null",
      "safe_pattern": "encrypted",
      "level": "critical",
      "description": "Data partition should be encrypted"
    },
    {
      "category": "PRIVACY",
      "label": "SD Card Encryption",
      "command": "getprop ro.crypto.sdcard 2>/dev/null",
      "safe_pattern": "encrypted|true",
      "level": "warning",
      "description": "SD card should be encrypted if present"
    },
    {
      "category": "PRIVACY",
      "label": "Backup Files on Device",
      "command": "find /sdcard /data -name '*.bak' -o -name '*.backup' -o -name '*.old' 2>/dev/null | head -5",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Backup files may contain sensitive data",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Log Files Accessible",
      "command": "find /data /sdcard -name '*.log' -type f 2>/dev/null | head -5",
      "safe_pattern": ".",
      "level": "info",
      "description": "Log files may contain sensitive information"
    },
    {
      "category": "PRIVACY",
      "label": "Cleartext Storage Check",
      "command": "find /data -name 'shared_prefs' -type d 2>/dev/null | head -3",
      "safe_pattern": ".",
      "level": "info",
      "description": "SharedPreferences directories - may store data in cleartext"
    },
    {
      "category": "PRIVACY",
      "label": "Location Data Stored",
      "command": "find /data -type f -name '*.db' -exec sqlite3 {} \"SELECT name FROM sqlite_master WHERE name LIKE '%location%' OR name LIKE '%gps%';\" \\; 2>/dev/null | head -5",
      "safe_pattern": "^$",
      "level": "info",
      "description": "Location tracking databases",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Database Files Present",
      "command": "find /data -name '*.db' -o -name '*.sqlite' 2>/dev/null | wc -l",
      "safe_pattern": ".",
      "level": "info",
      "description": "Database files count - may contain PHI, verify encryption"
    },
    {
      "category": "PRIVACY",
      "label": "Unencrypted PHI Indicators",
      "command": "find /sdcard /data -type f \\( -name '*.csv' -o -name '*.txt' -o -name '*.xml' \\) -exec grep -l -iE 'patient|ssn|dob|mrn|diagnosis|medication' {} \\; 2>/dev/null | head -5",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Potential unencrypted PHI found - HIPAA violation risk!",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Log Files with PHI Risk",
      "command": "find /data -name '*.log' -exec grep -l -iE 'patient|name|ssn|dob|mrn' {} \\; 2>/dev/null | head -5",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Log files may contain PHI - must be encrypted or purged",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "Backup Files Present",
      "command": "find /sdcard /data -name '*.bak' -o -name '*.backup' -o -name '*export*' 2>/dev/null | head -5",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Backup files may contain unencrypted PHI",
      "empty_is_safe": true
    },
    {
      "category": "PRIVACY",
      "label": "External Storage PHI Risk",
      "command": "ls /sdcard/*.db /sdcard/*.csv /sdcard/Download/*.db 2>/dev/null",
      "safe_pattern": "^$",
      "level": "critical",
      "description": "Sensitive files on unencrypted external storage - PHI exposure risk!",
      "empty_is_safe": true
    }
  ]
}