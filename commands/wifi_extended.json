{
  "checks": [
    {
      "category": "WIFI EXTENDED",
      "label": "WiFi Direct Enabled",
      "command": "settings get global wifi_p2p_device_name 2>/dev/null",
      "safe_pattern": "^(null)?$",
      "level": "warning",
      "description": "WiFi Direct can expose device to nearby attacks"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "Mobile Hotspot Active",
      "command": "dumpsys wifi 2>/dev/null | grep -i 'SoftAP.*enabled'",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Mobile hotspot creates attack surface"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "Hotspot SSID Broadcast",
      "command": "settings get global tether_wifi_ssid 2>/dev/null",
      "safe_pattern": ".*",
      "level": "info",
      "description": "Hotspot SSID configuration"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "Saved Networks Count",
      "command": "wpa_cli list_networks 2>/dev/null | tail -n +2 | wc -l || dumpsys wifi 2>/dev/null | grep 'ConfigKey' | wc -l",
      "safe_pattern": "^[0-9]{1,2}$",
      "level": "info",
      "description": "Number of saved WiFi networks"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "Open Networks Saved",
      "command": "dumpsys wifi 2>/dev/null | grep -E 'KeyMgmt.*NONE' | wc -l",
      "safe_pattern": "^0$",
      "level": "warning",
      "description": "Open (unencrypted) networks saved"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "WiFi Scanning Always Available",
      "command": "settings get global wifi_scan_always_enabled",
      "safe_pattern": "^0$",
      "level": "warning",
      "description": "Background WiFi scanning for location"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "Miracast/Screen Cast",
      "command": "settings get global wifi_display_on 2>/dev/null",
      "safe_pattern": "^(0|null)$",
      "level": "info",
      "description": "Wireless display broadcasting status"
    },
    {
      "category": "WIFI EXTENDED",
      "label": "WiFi MAC Randomization",
      "command": "settings get global wifi_connected_mac_randomization_enabled 2>/dev/null",
      "safe_pattern": "^1$",
      "level": "warning",
      "description": "WiFi MAC randomization prevents tracking"
    }
  ]
}