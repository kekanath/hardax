{
  "checks": [
    {
      "category": "NETWORK-IPV6",
      "label": "All Active TCP Connections (IPv6, excluding ::1)",
      "command": "sh -lc 'netstat -ntp 2>/dev/null || ss -ntp 2>/dev/null || true' | awk '$1 ~ /^tcp6/ && $4 !~ /::1/ { print $0 }'",
      "safe_pattern": "^\\s*$",
      "level": "info",
      "description": "Displays all active IPv6 TCP connections (including LISTEN/ESTABLISHED) that are not bound to loopback (::1)"
    },
    {
      "category": "NETWORK-IPV6",
      "label": "Common TCP Ports Exposed (IPv6, Warning)",
      "command": "sh -lc 'netstat -lnpt 2>/dev/null || ss -lnpt 2>/dev/null || true' | awk '$1 ~ /^tcp6/ && $0 ~ /LISTEN/ && $4 ~ /:((53)|(80)|(25)|(110)|(143)|(465)|(587)|(993)|(995)|(8080)|(8443)|(22))$/ && $4 !~ /::1/'",
      "safe_pattern": "^\\s*$",
      "level": "warning",
      "description": "One or more common TCP ports are externally accessible on IPv6 — review exposure"
    },
    {
      "category": "NETWORK-IPV6",
      "label": "Expanded Critical TCP Ports (excluding SSH) Listening or External (IPv6)",
      "command": "sh -lc 'netstat -lnpt 2>/dev/null || ss -lnpt 2>/dev/null || true' | awk '$1 ~ /^tcp6/ && $0 ~ /LISTEN/ && $4 ~ /:((21)|(23)|(25)|(445)|(3306)|(5432)|(5900)|(5901)|(3389)|(5555)|(4444)|(8080)|(8443)|(41795))$/ && $4 !~ /::1/'",
      "safe_pattern": "^\\s*$",
      "level": "critical",
      "description": "One or more critical TCP ports (excluding SSH) are open or externally connected (IPv6) — review exposure"
    },
    {
      "category": "NETWORK-IPV6",
      "label": "Open UDP Ports (IPv6, excluding localhost)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp6/ && $4 !~ /::1/'",
      "safe_pattern": "^\\s*$",
      "level": "info",
      "description": "Open UDP ports (IPv6) found that are not restricted to localhost (::1)"
    },
    {
      "category": "NETWORK-IPV6",
      "label": "UDP Ports 123, 161, 162, 5353 Open (IPv6)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp6/ && $4 ~ /:(123|161|162|5353)$/ && $4 !~ /::1/ { print $4 }'",
      "safe_pattern": "^\\s*$",
      "level": "warning",
      "description": "UDP Ports 123 (NTP), 161 (SNMP), 162 (Trap), or 5353 (mDNS) are exposed on IPv6 — may leak device or service data"
    },
    {
      "category": "NETWORK-IPV6",
      "label": "Potentially Vulnerable UDP Ports (IPv6)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp6/ && $4 ~ /:(69|1900|500|4500|520)$/ && $4 !~ /::1/ { print $4 }'",
      "safe_pattern": "^\\s*$",
      "level": "critical",
      "description": "One or more UDP ports (e.g., 69/TFTP, 1900/SSDP) are exposed on IPv6 — potentially vulnerable services detected"
    }
  ]
}