{
  "checks": [
    {
      "category": "NETWORK-IPV4",
      "label": "All Active TCP Connections (IPv4)",
      "command": "sh -lc 'netstat -lntp 2>/dev/null || ss -lntp 2>/dev/null || true' | awk '$1 ~ /^tcp/ && $4 ~ /^[0-9.]+:/ { print $0 }'",
      "safe_pattern": "^\\s*$",
      "level": "info",
      "description": "Lists all IPv4 TCP connections including localhost — use for full socket audit"
    },
    {
      "category": "NETWORK-IPV4",
      "label": "Common TCP Ports Exposed (IPv4, Warning)",
      "command": "sh -lc 'netstat -lnpt 2>/dev/null || ss -lnpt 2>/dev/null || true' | awk '$1 ~ /^tcp/ && $0 ~ /LISTEN/ && $4 ~ /:((53)|(80)|(25)|(110)|(143)|(465)|(587)|(993)|(995)|(8080)|(8443)|(22))$/ && $4 !~ /^127\\./'",
      "safe_pattern": "^\\s*$",
      "level": "warning",
      "description": "One or more common TCP ports are externally accessible on IPv4 — review exposure"
    },
    {
      "category": "NETWORK-IPV4",
      "label": "Expanded Critical TCP Ports (excluding SSH) Listening or External (IPv4)",
      "command": "sh -lc 'netstat -lnpt 2>/dev/null || ss -lnpt 2>/dev/null || true' | awk '$1 ~ /^tcp/ && $0 ~ /LISTEN/ && $4 ~ /:((21)|(23)|(25)|(445)|(3306)|(5432)|(5555)|(5900)|(5901)|(3389)|(5555)|(4444)|(8080)|(8443)|(41795))$/ && $4 !~ /^127\\./'",
      "safe_pattern": "^\\s*$",
      "level": "critical",
      "description": "One or more critical TCP ports (excluding SSH) are open or externally connected (IPv4) — review exposure"
    },
    {
      "category": "NETWORK-IPV4",
      "label": "Open UDP Ports (IPv4, excluding localhost)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp/ && $4 !~ /^127\\./'",
      "safe_pattern": "^\\s*$",
      "level": "info",
      "description": "Open UDP ports (IPv4) found that are not restricted to localhost"
    },
    {
      "category": "NETWORK-IPV4",
      "label": "UDP Ports 123, 161, 162, 5353 Open (IPv4)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp/ && $4 ~ /:(123|161|162|5353)$/ && $4 !~ /^127\\./ { print $4 }'",
      "safe_pattern": "^\\s*$",
      "level": "warning",
      "description": "UDP Ports 123 (NTP), 161 (SNMP), 162 (Trap), or 5353 (mDNS) are exposed on IPv4 — may leak device or service data"
    },
    {
      "category": "NETWORK-IPV4",
      "label": "Potentially Vulnerable UDP Ports (IPv4)",
      "command": "sh -lc 'netstat -lnup 2>/dev/null || ss -lnup 2>/dev/null || true' | awk '$1 ~ /^udp/ && $4 ~ /:(69|1900|500|4500|520)$/ && $4 !~ /^127\\./ { print $4 }'",
      "safe_pattern": "^\\s*$",
      "level": "critical",
      "description": "One or more UDP ports (e.g., 69/TFTP, 1900/SSDP) are exposed on IPv4 — potentially vulnerable services detected"
    }
  ]
}