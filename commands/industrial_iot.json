{
  "checks": [
    {
      "category": "INDUSTRIAL IOT",
      "label": "SELinux Enforcing (Mandatory)",
      "command": "getenforce",
      "safe_pattern": "^Enforcing$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 2.1"],
        "nist_800_82": ["AC-3"]
      },
      "description": "SELinux mandatory access control required for industrial systems"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Secure Boot Chain",
      "command": "getprop ro.boot.verifiedbootstate",
      "safe_pattern": "^green$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.4"],
        "nist_800_82": ["SI-7"]
      },
      "description": "Verified boot ensures firmware integrity for industrial controllers"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "dm-verity System Integrity",
      "command": "grep -o 'androidboot.veritymode=[^ ]*' /proc/cmdline 2>/dev/null | cut -d= -f2",
      "safe_pattern": "^enforcing$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.4"]
      },
      "description": "dm-verity ensures system partition integrity"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Network Interface Inventory",
      "command": "ip addr show | grep -E '^[0-9]+:' | awk '{print $2}'",
      "safe_pattern": ".*",
      "level": "info",
      "compliance": {
        "iec_62443": ["SR 5.1"],
        "nist_800_82": ["SC-7"]
      },
      "description": "Network interfaces for segmentation analysis"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Critical Ports Exposed",
      "command": "netstat -tlnp 2>/dev/null | grep -E ':502|:102|:44818|:47808|:20000' | grep -v '127.0.0.1'",
      "safe_pattern": "^$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 5.1"],
        "nist_800_82": ["SC-7"]
      },
      "description": "Industrial protocol ports (Modbus, S7, EtherNet/IP, BACnet) should not be externally exposed"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Firewall Rules Present",
      "command": "iptables -L 2>/dev/null | wc -l",
      "safe_pattern": "^[5-9]|^[1-9][0-9]",
      "level": "warning",
      "compliance": {
        "iec_62443": ["SR 5.2"],
        "nist_800_82": ["SC-7"]
      },
      "description": "Host-based firewall rules should be configured"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "USB Mass Storage Disabled",
      "command": "settings get global usb_mass_storage_enabled 2>/dev/null",
      "safe_pattern": "^0$|^null$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 2.3"],
        "nist_800_82": ["MP-7"]
      },
      "description": "USB mass storage should be disabled to prevent malware introduction"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "ADB Debugging Disabled",
      "command": "settings get global adb_enabled",
      "safe_pattern": "^0$|^null$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 1.3"],
        "nist_800_82": ["AC-17"]
      },
      "description": "Debug interfaces must be disabled on production industrial systems"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Kernel Module Loading Restricted",
      "command": "cat /proc/sys/kernel/modules_disabled",
      "safe_pattern": "^1$",
      "level": "warning",
      "compliance": {
        "iec_62443": ["SR 3.4"],
        "nist_800_82": ["CM-7"]
      },
      "description": "Kernel module loading should be disabled after boot"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Kernel Pointer Restriction",
      "command": "cat /proc/sys/kernel/kptr_restrict",
      "safe_pattern": "^2$",
      "level": "warning",
      "compliance": {
        "iec_62443": ["SR 3.1"]
      },
      "description": "Kernel pointers should be fully restricted (2)"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "ASLR Enabled",
      "command": "cat /proc/sys/kernel/randomize_va_space",
      "safe_pattern": "^2$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.1"],
        "nist_800_82": ["SI-16"]
      },
      "description": "Address Space Layout Randomization must be enabled (value 2)"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "dmesg Restriction",
      "command": "cat /proc/sys/kernel/dmesg_restrict",
      "safe_pattern": "^1$",
      "level": "warning",
      "compliance": {
        "iec_62443": ["SR 2.8"],
        "nist_800_82": ["AU-9"]
      },
      "description": "Kernel log access should be restricted from unprivileged users"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Core Dumps Disabled",
      "command": "cat /proc/sys/kernel/core_pattern",
      "safe_pattern": "^\\|/dev/null$|^$",
      "level": "warning",
      "compliance": {
        "iec_62443": ["SR 3.4"],
        "nist_800_82": ["SC-4"]
      },
      "description": "Core dumps should be disabled to prevent sensitive data leakage"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Audit Logging Active",
      "command": "cat /proc/sys/kernel/printk | awk '{print $1}'",
      "safe_pattern": "^[4-7]$",
      "level": "info",
      "compliance": {
        "iec_62443": ["SR 2.8"],
        "nist_800_82": ["AU-2"]
      },
      "description": "Audit logging level for security events"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Time Synchronization",
      "command": "getprop persist.sys.timezone && settings get global auto_time",
      "safe_pattern": ".*",
      "level": "info",
      "compliance": {
        "iec_62443": ["SR 2.10"],
        "nist_800_82": ["AU-8"]
      },
      "description": "Time synchronization for accurate audit logs"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Encryption at Rest",
      "command": "getprop ro.crypto.state",
      "safe_pattern": "^encrypted$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.4"],
        "nist_800_82": ["SC-28"]
      },
      "description": "Storage encryption protects configuration and process data"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Screen Lock Required",
      "command": "dumpsys keyguard 2>/dev/null | grep 'secure' | head -1",
      "safe_pattern": "secure.*true",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 1.1"],
        "nist_800_82": ["AC-11"]
      },
      "description": "Physical access control via screen lock"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Unknown Sources Disabled",
      "command": "settings get secure install_non_market_apps",
      "safe_pattern": "^0$|^null$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.4"],
        "nist_800_82": ["CM-11"]
      },
      "description": "Sideloading apps must be disabled on industrial systems"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Security Patch Age",
      "command": "getprop ro.build.version.security_patch",
      "safe_pattern": "^20[2-9][0-9]-[0-9]{2}-[0-9]{2}$",
      "level": "critical",
      "compliance": {
        "iec_62443": ["SR 3.3"],
        "nist_800_82": ["SI-2"]
      },
      "description": "Security patches must be applied within ICS patch windows"
    },
    {
      "category": "INDUSTRIAL IOT",
      "label": "Running Process Count",
      "command": "ps -A | wc -l",
      "safe_pattern": "^[0-9]+$",
      "level": "info",
      "compliance": {
        "iec_62443": ["SR 2.1"]
      },
      "description": "Process inventory for attack surface analysis"
    }
  ]
}
