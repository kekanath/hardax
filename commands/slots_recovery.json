{
  "checks": [
    {
      "category": "SLOTS & RECOVERY",
      "label": "bootctl Present",
      "command": "command -v bootctl >/dev/null 2>&1 && echo present || echo absent",
      "safe_pattern": "^present$",
      "level": "info",
      "description": "bootctl available to query slot state"
    },
    {
      "category": "SLOTS & RECOVERY",
      "label": "Current Slot",
      "command": "bootctl get-current-slot 2>/dev/null | sed -E 's/.*: *//'",
      "safe_pattern": "^(a|b|0|1)$",
      "level": "info",
      "description": "Device reports current boot slot (a/b or 0/1)"
    },
    {
      "category": "SLOTS & RECOVERY",
      "label": "Stock Recovery (No TWRP in PATH)",
      "command": "command -v twrp >/dev/null 2>&1 && echo found || echo notfound",
      "safe_pattern": "^notfound$",
      "level": "high",
      "description": "No custom recovery binary should be present"
    }
  ]
}