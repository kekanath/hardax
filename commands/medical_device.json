{
  "checks": [
    {
      "category": "MEDICAL DEVICE",
      "label": "PHI Encryption at Rest",
      "command": "getprop ro.crypto.state",
      "safe_pattern": "^encrypted$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Data Protection"],
        "hipaa": ["164.312(a)(2)(iv)"]
      },
      "description": "Protected Health Information (PHI) must be encrypted at rest per HIPAA"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "File-Based Encryption Type",
      "command": "getprop ro.crypto.type",
      "safe_pattern": "file|block",
      "level": "info",
      "compliance": {
        "fda_524b": ["Data Protection"]
      },
      "description": "Encryption type (FBE preferred over FDE for medical devices)"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Hardware-Backed Keystore",
      "command": "getprop ro.hardware.keystore",
      "safe_pattern": "strongbox|trusty|tee",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Cryptography"],
        "hipaa": ["164.312(e)(2)(ii)"]
      },
      "description": "Cryptographic keys must be stored in hardware security module"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "TEE Presence for PHI Protection",
      "command": "ls /dev/tee* /dev/teepriv* 2>/dev/null | wc -l",
      "safe_pattern": "^[1-9]",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Cryptography"]
      },
      "description": "Trusted Execution Environment required for secure key operations"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Security Audit Logging",
      "command": "logcat -b security -d 2>/dev/null | wc -l",
      "safe_pattern": "^[1-9]",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Audit Controls"],
        "hipaa": ["164.312(b)"]
      },
      "description": "Security audit logging required for HIPAA compliance"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Logd Security Buffer",
      "command": "getprop persist.logd.security",
      "safe_pattern": "true|1",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Audit Controls"],
        "hipaa": ["164.312(b)"]
      },
      "description": "Security log buffer should be enabled"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Screen Lock Enforced",
      "command": "dumpsys keyguard 2>/dev/null | grep 'secure' | head -1",
      "safe_pattern": "secure.*true|Showing.*true",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Access Control"],
        "hipaa": ["164.312(a)(1)"]
      },
      "description": "Device must require authentication to prevent unauthorized PHI access"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Session Timeout",
      "command": "settings get secure lock_screen_lock_after_timeout",
      "safe_pattern": "^[0-9]{1,6}$",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Access Control"],
        "hipaa": ["164.312(a)(2)(iii)"]
      },
      "description": "Automatic session timeout prevents unauthorized access to unattended devices"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Biometric Authentication Strength",
      "command": "dumpsys biometric 2>/dev/null | grep -i 'strength' | head -1",
      "safe_pattern": "STRONG",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Authentication"]
      },
      "description": "Biometric auth must be STRONG level (not WEAK)"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "TLS Version (Network Security)",
      "command": "getprop | grep -iE 'tls|ssl' | grep -v '#'",
      "safe_pattern": "1\\.[23]",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Transmission Security"],
        "hipaa": ["164.312(e)(1)"]
      },
      "description": "All PHI transmission must use TLS 1.2 or higher"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Network Certificate Store",
      "command": "ls /system/etc/security/cacerts/ 2>/dev/null | wc -l",
      "safe_pattern": "^[1-9][0-9]*",
      "level": "info",
      "compliance": {
        "fda_524b": ["Transmission Security"]
      },
      "description": "System CA certificates present for TLS validation"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Custom CA Certificates (Risk)",
      "command": "ls /data/misc/user/0/cacerts-added/ 2>/dev/null | wc -l",
      "safe_pattern": "^0$",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Network Security"]
      },
      "description": "Custom CA certificates may enable MITM attacks on PHI"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Exposed Network Ports",
      "command": "netstat -tlnp 2>/dev/null | grep -v '127.0.0.1' | grep LISTEN | wc -l",
      "safe_pattern": "^[0-3]$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Network Security"],
        "hipaa": ["164.312(e)(1)"]
      },
      "description": "Minimize exposed network ports to reduce attack surface"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Security Patch Level",
      "command": "getprop ro.build.version.security_patch",
      "safe_pattern": "^20[2-9][0-9]-[0-9]{2}-[0-9]{2}$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Vulnerability Management"]
      },
      "description": "Security patch level - FDA requires timely patching of vulnerabilities"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Firmware Integrity (Verified Boot)",
      "command": "getprop ro.boot.verifiedbootstate",
      "safe_pattern": "^green$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Software Integrity"]
      },
      "description": "Boot chain integrity ensures firmware has not been tampered"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Build Type (Release)",
      "command": "getprop ro.build.type",
      "safe_pattern": "user$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Device Security"]
      },
      "description": "Production medical devices must use release builds, not userdebug/eng"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "USB Debugging Disabled",
      "command": "settings get global adb_enabled",
      "safe_pattern": "^0$|^null$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Access Control"],
        "hipaa": ["164.312(a)(1)"]
      },
      "description": "USB debugging must be disabled on production medical devices"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Developer Options Disabled",
      "command": "settings get global development_settings_enabled",
      "safe_pattern": "^0$|^null$",
      "level": "critical",
      "compliance": {
        "fda_524b": ["Device Security"]
      },
      "description": "Developer options must be disabled on production devices"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Device Admin/MDM Enrollment",
      "command": "dumpsys device_policy 2>/dev/null | grep -E 'Admin:|Owner' | head -3",
      "safe_pattern": ".*",
      "level": "info",
      "compliance": {
        "fda_524b": ["Device Management"]
      },
      "description": "MDM enrollment status for enterprise device management"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Remote Wipe Capability",
      "command": "dumpsys device_policy 2>/dev/null | grep -i 'wipe' | head -1",
      "safe_pattern": "wipe",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Device Management"],
        "hipaa": ["164.310(d)(2)(i)"]
      },
      "description": "Remote wipe capability for lost/stolen device containing PHI"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Backup Disabled (PHI Protection)",
      "command": "settings get global backup_enabled",
      "safe_pattern": "^0$|^null$",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Data Protection"],
        "hipaa": ["164.312(c)(1)"]
      },
      "description": "Auto-backup should be disabled to prevent PHI leakage"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Clipboard Monitor",
      "command": "cmd clipboard get-primary-clip 2>/dev/null || echo 'empty'",
      "safe_pattern": "^$|empty|null",
      "level": "info",
      "compliance": {
        "hipaa": ["164.312(a)(1)"]
      },
      "description": "Clipboard should not contain sensitive PHI data"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "FIPS Cryptographic Provider",
      "command": "getprop ro.crypto.fips_provider 2>/dev/null || cat /proc/sys/crypto/fips_enabled 2>/dev/null",
      "safe_pattern": "boringssl|openssl|1",
      "level": "info",
      "compliance": {
        "fda_524b": ["Cryptography"]
      },
      "description": "FIPS-validated cryptography may be required for federal healthcare"
    },
    {
      "category": "MEDICAL DEVICE",
      "label": "Entropy for Crypto Operations",
      "command": "cat /proc/sys/kernel/random/entropy_avail",
      "safe_pattern": "^[2-9][0-9]{2,}|^[1-9][0-9]{3,}",
      "level": "warning",
      "compliance": {
        "fda_524b": ["Cryptography"]
      },
      "description": "Sufficient entropy (>256) required for secure cryptographic operations"
    }
  ]
}
