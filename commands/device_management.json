{
  "checks": [
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "User Accounts Count",
      "command": "pm list users 2>/dev/null | wc -l",
      "safe_pattern": "^[12]$",
      "level": "warning",
      "description": "Multiple users may have different security levels"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Guest Account Exists",
      "command": "pm list users 2>/dev/null | grep -i guest",
      "safe_pattern": "^$",
      "level": "warning",
      "description": "Guest account may bypass security",
      "empty_is_safe": true
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Work Profile",
      "command": "pm list users 2>/dev/null | grep -i work",
      "safe_pattern": ".",
      "level": "info",
      "description": "Work profile status"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Sync Accounts",
      "command": "dumpsys account 2>/dev/null | grep -i 'Account {' | wc -l",
      "safe_pattern": ".",
      "level": "info",
      "description": "Number of synced accounts"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Developer Options Disabled",
      "command": "settings get global development_settings_enabled",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Developer options should be disabled in production"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Stay Awake Disabled",
      "command": "settings get global stay_on_while_plugged_in",
      "safe_pattern": "0|null",
      "level": "info",
      "description": "Stay awake while charging can be a security risk"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Mock Location Disabled",
      "command": "settings get secure mock_location",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "Mock locations should be disabled"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "OEM Unlocking Disabled",
      "command": "settings get global oem_unlock_enabled",
      "safe_pattern": "0|null",
      "level": "critical",
      "description": "OEM unlocking allows bootloader unlock - should be disabled"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Bluetooth HCI Snoop Log",
      "command": "settings get global bluetooth_hci_log",
      "safe_pattern": "0|null",
      "level": "warning",
      "description": "BT HCI snoop log captures all Bluetooth traffic"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Device Admin Apps",
      "command": "dumpsys device_policy 2>/dev/null | grep -i admin | head -10",
      "safe_pattern": ".",
      "level": "info",
      "description": "Device administrator applications"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Device Owner",
      "command": "dumpsys device_policy 2>/dev/null | grep -i 'device owner'",
      "safe_pattern": ".",
      "level": "info",
      "description": "Enterprise device owner status"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Profile Owner",
      "command": "dumpsys device_policy 2>/dev/null | grep -i 'profile owner'",
      "safe_pattern": ".",
      "level": "info",
      "description": "Work profile owner status"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Enterprise Encryption",
      "command": "dumpsys device_policy 2>/dev/null | grep -i 'encryption'",
      "safe_pattern": ".",
      "level": "info",
      "description": "Enterprise encryption policy"
    },
    {
      "category": "DEVICE_MANAGEMENT",
      "label": "Password Policy",
      "command": "dumpsys device_policy 2>/dev/null | grep -i 'password'",
      "safe_pattern": ".",
      "level": "info",
      "description": "Password quality requirements"
    }
  ]
}